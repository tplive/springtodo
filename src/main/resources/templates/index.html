<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8"/>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet"
          href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
          integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"
          crossorigin="anonymous"/>

    <!-- Optional theme -->
    <link rel="stylesheet"
          href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css"
          integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp"
          crossorigin="anonymous"/>


    <title>Total Todo</title>
</head>

<body style="padding-top:100px;">

<div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <a class="navbar-brand" href="#">Total Todo</a>
        </div>
    </div>
</div>

<form id="todoForm">
    <input type="text" id="textInput" />
    <input type="date" id="startInput" />
    <input type="date" id="endInput" />
    <input type="submit" onclick="send()"/>
</form>

<ul id="todos" th:each="p : ${todoList}">
    <li th:text="${p.text}"/>
</ul>

<table id="todoItems">
    <thead>
    <tr>
        <th>Text</th>
        <th>Start</th>
        <th>End</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="item : ${todoList}">
        <td th:text="${item.text">Item_name</td>
        <td th:text="${item.start">Item_name</td>
        <td th:text="${item.end">Item_name</td>
    </tr>
    </tbody>
</table>
<p><a href="#" onclick="refreshList()">Refresh list</a> </p>

<!-- Load jQuery before Bootstrap -->
<script src="https://code.jquery.com/jquery-3.2.1.min.js"
        integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
        crossorigin="anonymous"></script>

<!-- Latest compiled and minified JavaScript -->
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"
        integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
        crossorigin="anonymous"></script>

<script>
    /*<![CDATA[*/
    function send(){
        // AJAX KODE HER
        var text = document.getElementById("textInput").value;
        var start = document.getElementById("startInput").value;
        var end = document.getElementById("endInput").value;
        var xmlHttp = new XMLHttpRequest();
        xmlHttp.onreadystatechange = function(){
            if(xmlHttp.readyState == 4 && xmlHttp.status == 200){
                console.log();
            }
        }
        xmlHttp.open("POST", "/save", true);
        xmlHttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
        xmlHttp.send("text="+text+"&start="+start+"&end="+end);
    }
    function refreshList(){
        var xmlHttp = new XMLHttpRequest();
        xmlHttp.onreadystatechange = function(){
            if(xmlHttp.readyState == 4 && xmlHttp.status == 200){
                console.log(xmlHttp.responseText);
                json = JSON.parse(xmlHttp.responseText);
                json.forEach(function(entry){
                    console.log(entry);
                    var ul = document.getElementById("todos");
                    var li = document.createElement("li");
                    li.innerHTML = todos.text+" - "+todos.start+" - "+todos.end;
                    ul.appendChild(li);
                });
            }
        }
        xmlHttp.open("GET", "/index/json", true);
        xmlHttp.send();
    }
    /*]]>*/
</script>
</body>

</html>
